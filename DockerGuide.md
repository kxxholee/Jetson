# Docker ğŸ³

> ***TODO list***
> - ~[ ] Windowsì—ì„œì˜ Docker ì‚¬ìš©ì— ëŒ€í•œ ì¡°ì‚¬~
> - [x] Docker í™˜ê²½ì„ ë§Œë“¤ê³  ì—…ë¡œë“œ
> - [x] Docker í™˜ê²½ì— ê¸°ì´ˆì ì¸ ì˜ì¡´ì„± ì„¤ì¹˜
> - ~[ ] Docker í™˜ê²½ì— NVIDIA Driverì™€ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜~
> - [X] Docker Hub ì ‘ì†í•˜ê¸° ìœ„í•œ ì¤€ë¹„ë¬¼ ì•ˆë‚´  
> - [X] README ì‘ì„±

## 0. Dockerë€? 
DockerëŠ” ì–´ë–¤ ê°€ìƒ í™˜ê²½ì„ ë§Œë“¤ì–´ì„œ ë°°í¬í•˜ê¸° ìœ„í•œ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤. ì›í•˜ëŠ” osë¥¼ ì„ íƒí•´ ê°€ìƒì˜ í™˜ê²½ì„ ë§Œë“¤ê³ , ì›í•˜ëŠ” ì˜ì¡´ì„±ë“¤ì„ ì„¤ì¹˜í•´ì„œ ë‚˜ë§Œì˜ í™˜ê²½ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
> [!NOTE]
> * Condaì™€ì˜ ì°¨ì´ì 
> Conda í™˜ê²½ì€ ë‚´ ë¡œì»¬ í™˜ê²½ì—ì„œ, ì£¼ë¡œ Pythonì´ë‚˜ Rì„ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ë”¥ëŸ¬ë‹ / ë¨¸ì‹ ëŸ¬ë‹ ì½”ë“œë“¤ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ë° ì‚¬ìš©ë˜ëŠ” í™˜ê²½ì´ë‹¤. ë‚´ê°€ í•„ìš”í•œ ì˜ì¡´ì„±ë§Œì„ Conda ê°€ìƒ í™˜ê²½ì— ë§Œë“¤ì–´ ì£¼ê³ , í™œì„±í™”ì‹œì¼œ ì¤„ ë•Œë§ˆë‹¤ í˜„ì¬ í”„ë¡œì íŠ¸ì— í•„ìš”í•œ ì˜ì¡´ì„±ë“¤ì„ ë¶ˆëŸ¬ì™€ ì“¸ ìˆ˜ ìˆëŠ” ì‹ì´ë‹¤.  
> ë°˜ë©´, DockerëŠ” Pythonì— ëŒ€í•œ ëª‡ëª‡ ì˜ì¡´ì„± ë¿ ì•„ë‹ˆë¼, OSìˆ˜ì¤€ì—ì„œ ìƒˆë¡œìš´ í™˜ê²½ì„ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ë‹¤ë¥´ë‹¤. ê·¸ë¦¬ê³  Gitì„ ì‚¬ìš©í•˜ë“¯ì´ ë‚´ê°€ ë§Œë“¤ê±°ë‚˜ ìˆ˜ì •í•œ ë‚´ìš©ë“¤ì„ Docker Hubì— ì—…ë¡œë“œí•´ë‘ê³  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
> * Gitê³¼ì˜ ì°¨ì´ì 
> ì´ëŠ” êµ³ì´ ë³´ì§€ ì•Šì•„ë„ ì˜ ì•Œê³  ìˆì„ ê²ƒì´ë¼ê³  ìƒê°í•œë‹¤. Gitì€ ì–´ë–¤ í”„ë¡œì íŠ¸ì— ëŒ€í•´ì„œ, ì—¬ëŸ¬ ê°œì˜ íŒŒì¼ì„ ì—…ë¡œë“œ / ë‹¤ìš´ë¡œë“œí•˜ê¸° í¸í•˜ê²Œ í•˜ê¸° ìœ„í•´ ì¡´ì¬í•œë‹¤. ê·¸ë¦¬ê³  íŒŒì¼ì˜ í¬ê¸°ë‚˜ Repositoryì˜ í¬ê¸°ê°€ ì œí•œì ì´ë‹¤.  
> ë°˜ë©´ DockerëŠ” ì–´ë–¤ í™˜ê²½ ì „ì²´ë¥¼ ì´ë¯¸ì§€ì˜ í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ ì—…ë¡œë“œí•´ ë‘ê¸°ì—, AIí•™ìŠµì„ ìœ„í•œ ë°ì´í„°, CUDAì™€ PyTorch, Ultralyticsì˜  ë²„ì „ ê´€ë¦¬ ë° íŒ€ì›ë“¤ê³¼ì˜ í”„ë¡œì íŠ¸ ê³µìœ ê°€ ìš©ì´í•˜ë‹¤.  
>  

## 1. Docker ì‚¬ìš©ë²•
### 0. Docker ì„¤ì¹˜
ë¨¼ì €, ìì‹ ì˜ OSì— ë§ì¶”ì–´ì„œ Dockerë¥¼ ì„¤ì¹˜í•´ì•¼ í•œë‹¤.
#### Linux
```bash
$ curl -fsSL https://get.docker.com/ | sudo sh
```
#### Window & MAC OS
ì´ê±´ ì•„ì§ ëª¨ë¥¸ë‹¤. ì¡°ì‚¬í•´ì„œ ì•Œê²Œë˜ë©´ ì—…ë¡œë“œí•˜ê² ì§€ë§Œ, ì¡°ì‚¬í–ˆë‹¤ê³  í•´ì„œ ë‚´ê°€ ê²€ì¦í•´ë´¤ë‹¤ëŠ” ì†Œë¦¬ëŠ” ì•„ë‹ˆë‹¤. ë‚œ ë¦¬ëˆ…ìŠ¤ ìœ ì €ë‹¤.  
(+ Window ì‚¬ìš©ìë¼ë©´ ì œë°œ WSL2ë¥¼ ì‚¬ìš©í•˜ì. ì™œ ì•„ì§ë„ ê°€ìƒë¨¸ì‹ ì„ ì“°ëŠ”ì§€ ëª¨ë¥´ê² ë‹¤.)

### 1. Dockerfile ì‘ì„±
Dockerë¡œ ì–´ë–¤ í™˜ê²½ì„ ë§Œë“¤ë©´ì„œ ì–´ë–¤ ì‘ì—…ë“¤ì„ ìˆ˜í–‰í• ì§€ ì •í•´ ì£¼ëŠ” íŒŒì¼ì´ë‹¤.  
ë‚´ê°€ ì˜¬ë ¤ ë‘” Dockerí™˜ê²½ì€ ë‹¤ìŒê³¼ ê°™ì€ Dockerfileì„ ë”°ë¼ ë§Œë“¤ì–´ì¡Œë‹¤. ~~í•„ìš”í•´ë³´ì´ëŠ”ê±´ ë‹¤ ë•ŒëŸ¬ë°•ì•˜ë‹¤~~
```Dockerfile
# Ubuntu 22.04 ì´ë¯¸ì§€ ì‚¬ìš©
FROM ubuntu:22.04

# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN apt-get update && apt-get install -y \
	curl \
    wget \
    git \
    build-essential \
    vim \
    python3 \
    python3-pip \
    net-tools \
    iputils-ping \
    unzip \
    tar \
    htop \
    gnupg \
    software-properties-common

WORKDIR /app
```
ì´ë ‡ê²Œ í•´ì„œ Dockerfileì„ ëª¨ë‘ ì‘ì„±í–ˆë‹¤ë©´, ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¡œ Dockerfileì˜ ì˜ì¡´ì„±ì„ ê°€ì§€ëŠ” í™˜ê²½ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.  
ì°¸ê³ ë¡œ ë‚˜ëŠ” Ubuntu-22.04ë²„ì „ì˜ OSë¡œ ê°€ìƒ í™˜ê²½ì„ ë§Œë“¤ì—ˆë‹¤. ì•ìœ¼ë¡œ PyTorch, CUDA, cudnn, ê·¸ë¦¬ê³  ultralyticsì˜ ì„¤ì¹˜ë¥¼ ì¡°ì‚¬í•  ì˜ˆì •ì´ë‹¤.
```bash
$ docker build -t [Repository]:[tagname] .
$ docker build -t vanillapenguin/yolo-model:v1.0 . # ë‚´ê°€ ë§Œë“  docker í™˜ê²½ì˜ ì˜ˆì‹œ
```
### 2. Docker í™˜ê²½ì„ ì‚¬ìš©í•˜ê¸°
ì–´ë–¤ í™˜ê²½ì„ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©´, ê·¸ í™˜ê²½ì— ëŒ€í•´ `run`ì»¤ë§¨ë“œë¥¼ ì‚¬ìš©í•´ì„œ ê·¸ í™˜ê²½ì„ í™œì„±í™”í•´ì¤„ ìˆ˜ ìˆë‹¤.  
ì´ë•Œ, `-it`ì€ ì´ í™˜ê²½ì— ëŒ€í•´ì„œ ì§€ê¸ˆ í„°ë¯¸ë„ ì„¸ì…˜ì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ì†Œë¦¬ì´ê³ , ë§ˆì§€ë§‰ì˜ `/bin/bash`ëŠ” bash shell ë¡œ ì‹¤í–‰í•˜ê² ë‹¤ëŠ” ì†Œë¦¬ì´ë‹¤.  
ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰í•˜ë©´ ë‚´ê°€ ë§Œë“  í™˜ê²½ì— ëŒ€í•œ í„°ë¯¸ë„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
```bash
$ docker run -it [Repository]:[tagname] /bin/bash
$ docker build -t vanillapenguin/yolo-model:v1.0 . # ë‚´ê°€ ë§Œë“  docker í™˜ê²½ì˜ ì˜ˆì‹œ
```
ì´ë¯¸ runìœ¼ë¡œ í™œì„±í™”ëœ í™˜ê²½ì´ë¼ë©´ (ì´ë¯¸ ëŒì•„ê°€ê³  ìˆëŠ” í™˜ê²½ì´ë¼ë©´) ë‹¤ìŒê³¼ ê°™ì€ ëª…ë ¹ì–´ë¡œ í„°ë¯¸ë„ì„ ì¼¤ ìˆ˜ ìˆë‹¤.
```bash
$ docker exec -it my_container /bin/bash
```
### 3. sudo modeì—ì„œì˜ docker ìˆ˜í–‰ (user ì¶”ê°€)
> 1. ë¨¼ì €, Docker Groupì´ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•œë‹¤. ì´ëŠ” Dockerë¥¼ ì„¤ì¹˜í•  ë•Œ ìë™ìœ¼ë¡œ ì„¤ì¹˜ë˜ì–´ì•¼ í•œë‹¤.
>   ```bash
>   $ getent group docker
>   ```
> 2. í˜„ì¬ ì‚¬ìš©ìë¥¼ Docker Groupì— ë„£ì–´ ì£¼ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¨ ì¤„ ìˆ˜ ìˆë‹¤.
>   ```bash
>   $ sudo usermod -aG docker $USER
>   ```
> 3. Docker Groupì˜ ë©¤ë²„ê°€ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¨ ì£¼ë©´ ëœë‹¤.
>   ```bash
>   $ groups $USER
>   ```
> 4. Docker ëª…ë ¹ì–´ë“¤ì´ sudo ë¥¼ ì¨ ì£¼ì§€ ì•Šì•„ë„ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•œë‹¤ *(ì¢…ì¢… ì¬ë¶€íŒ…í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤)*

### 4. docker loginë° docker push
Docker loginì„ í•´ ì¤˜ì•¼ Docker Hubì— ì–´ë–¤ ì´ë¯¸ì§€ë¥¼ í‘¸ì‹œí•  ìˆ˜ ìˆë‹¤.  
ë‹¤ìŒê³¼ ê°™ì€ ëª…ë ¹ì–´ë¡œ Docker Loginì„ í•´ ë³´ì.
```bash
$ docker login
```
ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ê³  ë‚˜ë©´ Usernameê³¼ Passwordë¥¼ ì…ë ¥í•˜ë¼ëŠ” ì°½ì´ ë‚˜ì˜¨ë‹¤. Docker Hubì— ë¡œê·¸ì¸í–ˆë˜ ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë„£ì–´ ì£¼ë©´ ëœë‹¤. 

```bash
$ docker push [Repository]:[tagname]
$ docker push vanillapenguin/yolo-model:v1.0 # ë‚´ê°€ ë§Œë“  docker í™˜ê²½ì˜ ì˜ˆì‹œ
```

## 2. Docker *(ê·¸ ì™¸ ëª…ë ¹ì–´ë“¤)*
* Docker ì—ì„œ ë§ˆìš´íŠ¸ ì‚¬ìš©í•˜ê¸° *( -v flag ì‚¬ìš© )*
```bash
$ docker run -v /path/to/your/repository:/path/in/container -it image_name
```
* Docker Hub ì—ì„œ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸° 
```bash
$ docker pull username/repository:tag
```
* í˜„ì¬ Localì—ì„œ í”„ë¡œì„¸ìŠ¤ê°€ ì§„í–‰ ì¤‘ì¸ Dockerí™˜ê²½ ì‚´í´ë³´ê¸°
```bash
$ docker ps -a
```
* í˜„ì¬ Localì— ê°€ì§€ê³  ìˆëŠ” Docker Imageëª©ë¡ ì‚´í´ë³´ê¸°
```bash
$ docker images
```
* í˜„ì¬ í”„ë¡œì„¸ìŠ¤ê°€ ì§„í–‰ ì¤‘ì´ Docker í™˜ê²½ ì¢…ë£Œí•˜ê¸°
```bash
$ docker stop username/repository:tag
$ docker rm username/repository:tag
```
* ë¡œì»¬ì— ê°€ì§€ê³  ìˆëŠ” Docker Image ì‚­ì œí•˜ê¸°
```bash
$ docker rmi username/repository:tag
```
